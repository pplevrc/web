---
import CastImageSection from "@components/pages/cast/CastImageSection/CastImageSection.astro";
import CastNavigator from "@components/pages/cast/CastNavigator/CastNavigator.astro";
import CastProfileSection from "@components/pages/cast/CastProfileSection/CastProfileSection.astro";
import Layout from "@layouts/Layout.astro";
import { fetchCast, fetchCastNickNames } from "@lib/contents/casts";
import { pickColorBase } from "@lib/contents/commons/ColorToken";

export async function getStaticPaths() {
  const castNickNames = await fetchCastNickNames();

  return castNickNames.map((nickname) => ({ params: { nickname } }));
}

const { nickname } = Astro.params;

const { themeColor } = await fetchCast(nickname);

const colorName = pickColorBase(themeColor);
---

<Layout
  defineIcons={["link"]}
  headMeta={{
    title: `キャスト紹介: ${nickname} | ロリっ子喫茶ぷぷりえ`,
    description: `ロリっ子喫茶ぷぷりえのキャスト (${nickname}) を紹介するページです.`,
    keywords: [nickname],
  }}
  themeColor={colorName}
>
  <CastImageSection nickname={nickname} />
  <CastProfileSection nickname={nickname} />
  <CastNavigator nickname={nickname} />
</Layout>
