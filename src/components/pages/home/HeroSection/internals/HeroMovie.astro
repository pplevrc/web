---
/** biome-ignore-all lint/suspicious/noTsIgnore: ファイルが動的に作られるため */

// for poster image
// @ts-ignore ファイルが動的に作られるため
import thumbnail from "@assets/videos/top.generated.thumbnail.webp";
// @ts-ignore ファイルが動的に作られるため
import movieProdPcAv1 from "@assets/videos/top-pc.generated.av1.webm";
// @ts-ignore ファイルが動的に作られるため
import movieProdPcAv1MediaType from "@assets/videos/top-pc.generated.av1.webm?mediaType";
// @ts-ignore ファイルが動的に作られるため
import movieDevPcH264 from "@assets/videos/top-pc.generated.dev.h264.mp4";
// @ts-ignore ファイルが動的に作られるため
import movieDevPcH264MediaType from "@assets/videos/top-pc.generated.dev.h264.mp4?mediaType";
// @ts-ignore ファイルが動的に作られるため
import movieProdPcVp9 from "@assets/videos/top-pc.generated.vp9.webm";
// @ts-ignore ファイルが動的に作られるため
import movieProdPcVp9MediaType from "@assets/videos/top-pc.generated.vp9.webm?mediaType";
// @ts-ignore ファイルが動的に作られるため
import movieProdSpAv1 from "@assets/videos/top-sp.generated.av1.webm";
// @ts-ignore ファイルが動的に作られるため
import movieProdSpAv1MediaType from "@assets/videos/top-sp.generated.av1.webm?mediaType";
// @ts-ignore ファイルが動的に作られるため
import movieDevSpH264 from "@assets/videos/top-sp.generated.dev.h264.mp4";
// @ts-ignore ファイルが動的に作られるため
import movieDevSpH264MediaType from "@assets/videos/top-sp.generated.dev.h264.mp4?mediaType";
// @ts-ignore ファイルが動的に作られるため
import movieProdSpVp9 from "@assets/videos/top-sp.generated.vp9.webm";
// @ts-ignore ファイルが動的に作られるため
import movieProdSpVp9MediaType from "@assets/videos/top-sp.generated.vp9.webm?mediaType";

import ResponsiveVideo, {
  type Sources,
} from "@components/commons/ResponsiveVideo/ResponsiveVideo.astro";

const props = Astro.props;

const isDev = process.env["NODE_ENV"] !== "production";

const sources: Sources[] = (() => {
  if (isDev) {
    return [
      {
        pc: { src: movieDevPcH264, mediaType: movieDevPcH264MediaType },
        sp: { src: movieDevSpH264, mediaType: movieDevSpH264MediaType },
      },
    ];
  }
  return [
    {
      pc: { src: movieProdPcAv1, mediaType: movieProdPcAv1MediaType },
      sp: { src: movieProdSpAv1, mediaType: movieProdSpAv1MediaType },
    },
    {
      pc: { src: movieProdPcVp9, mediaType: movieProdPcVp9MediaType },
      sp: { src: movieProdSpVp9, mediaType: movieProdSpVp9MediaType },
    },
  ];
})();
---

<ResponsiveVideo
  muted
  autoplay
  playsinline
  disableRemotePlayback
  loop
  aria-label="ロリっ子喫茶ぷぷりえの紹介ムービー"
  preload="metadata"
  poster={thumbnail.src}
  sources={sources}
  {...props}
/>
